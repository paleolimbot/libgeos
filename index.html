<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Open Source Geometry Engine (GEOS) C API • libgeos</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Open Source Geometry Engine (GEOS) C API">
<meta property="og:description" content="Provides the Open Source Geometry Engine (GEOS) as a
  C API that can be used to write high-performance C and C++
  geometry operations using R as an interface. Headers are provided
  to make linking to and using these functions from C++ code as
  easy and as safe as possible. This package contains an internal
  copy of the GEOS library to guarantee the best possible
  consistency on multiple platforms.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">libgeos</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.8.1-3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/articles/rcpp-api.html">Using the LibGEOS Rcpp API</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/paleolimbot/libgeos/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="libgeos" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#libgeos" class="anchor"></a>libgeos</h1></div>
<!-- badges: start -->

<p>The goal of libgeos is to provide access to the <a href="https://trac.osgeo.org/geos/">GEOS</a> C API for high-performance geometry operations within the R package framework. This package contains a copy of the GEOS library, modified slightly to eliminate errors on all the platorms checked by CRAN and GitHub actions. This means you don’t have to install anything (other than the package) to take advantage of GEOS functions in R. It also means you don’t need a configure script if you’re writing a package that needs GEOS functionality (just <code>LinkingTo: libgeos</code>). Because GEOS is license under the LGPL, dynamically linking to GEOS (e.g., through the C API exposed in this package) is generally allowed from a package with any license. See the <a href="https://paleolimbot.github.io/geos">geos R package</a> for an R API to GEOS.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the released version of libgeos from <a href="https://cran.r-project.org/">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"libgeos"</span>)
</pre></div>
<p>To install a binary on supported Linux platforms, you can use <a href="https://packagemanager.rstudio.com/">RStudio Package Manager’s public instance</a> (see <a href="https://packagemanager.rstudio.com/client/#/repos/1/overview">here</a> for how to configure on your platform).</p>
<p>You can install the development version of libgeos from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="co"># install.packages("remotes")</span>
<span class="kw">remotes</span>::<span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span>(<span class="st">"paleolimbot/libgeos"</span>)
</pre></div>
</div>
<div id="example" class="section level2">
<h2 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h2>
<p>This package only exists for its exported C API, for which headers are provided to make calling these functions from Rcpp or another package as easy and as safe as possible.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb3-1"><a href="#cb3-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">// Packages will also need LinkingTo: libgeos</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">// [[Rcpp::depends(libgeos)]]</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">// needed in every file that uses GEOS functions</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="pp">#include </span><span class="im">"libgeos.h"</span></span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">// needed exactly once in your package or Rcpp script</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">// contains all the function pointers and the</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">// implementation of the function to initialize them</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">// (`libgeos_init_api()`)</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="pp">#include </span><span class="im">"libgeos.c"</span></span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">// this function needs to be called once before any GEOS functions</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">// are called (e.g., in .onLoad() for your package)</span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="dt">void</span> cpp_libgeos_init_api() {</span>
<span id="cb3-19"><a href="#cb3-19"></a>  libgeos_init_api();</span>
<span id="cb3-20"><a href="#cb3-20"></a>}</span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">// regular C or C++ code that uses GEOS functions!</span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="bu">std::</span>string version() {</span>
<span id="cb3-25"><a href="#cb3-25"></a>  <span class="cf">return</span> GEOSversion();</span>
<span id="cb3-26"><a href="#cb3-26"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="fu">cpp_libgeos_init_api</span>()
<span class="fu"><a href="https://rdrr.io/r/base/Version.html">version</a></span>()
<span class="co">#&gt; [1] "3.8.1-CAPI-1.13.3"</span>
</pre></div>
<p>Realistically, you will want to operate on some actual geometry! It isn’t possible to link directly to C++ objects in other packages, and working with the C API can be difficult if you aren’t used to managing memory yourself. To bridge this gap, the libgeos package provides a small header-only API that you can use to manage the pointers returned by functions in the GEOS C API.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb5-1"><a href="#cb5-1"></a><span class="pp">#include </span><span class="im">&lt;Rcpp.h&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">using</span> <span class="kw">namespace</span> Rcpp;</span>
<span id="cb5-3"><a href="#cb5-3"></a></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">// [[Rcpp::depends(libgeos)]]</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">// use this version of the header to use the LibGEOS C++ API</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="pp">#include </span><span class="im">"libgeos-rcpp.h"</span><span class="pp"> </span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="pp">#include </span><span class="im">"libgeos.c"</span></span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="dt">void</span> cpp_libgeos_init_api() {</span>
<span id="cb5-11"><a href="#cb5-11"></a>  libgeos_init_api();</span>
<span id="cb5-12"><a href="#cb5-12"></a>}</span>
<span id="cb5-13"><a href="#cb5-13"></a></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">// [[Rcpp::export]]</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>NumericVector wkt_area(CharacterVector wkt) {</span>
<span id="cb5-16"><a href="#cb5-16"></a>  NumericVector output(wkt.size());</span>
<span id="cb5-17"><a href="#cb5-17"></a>  </span>
<span id="cb5-18"><a href="#cb5-18"></a>  LibGEOSHandle handle;</span>
<span id="cb5-19"><a href="#cb5-19"></a>  LibGEOSWKTReader reader(handle);</span>
<span id="cb5-20"><a href="#cb5-20"></a>  <span class="cf">for</span> (<span class="dt">R_xlen_t</span> i = <span class="dv">0</span>; i &lt; wkt.size(); i++) {</span>
<span id="cb5-21"><a href="#cb5-21"></a>    LibGEOSGeometry geom = reader.read(wkt[i]);</span>
<span id="cb5-22"><a href="#cb5-22"></a>    GEOSArea_r(handle.get(), geom.get(), &amp;output[i]);</span>
<span id="cb5-23"><a href="#cb5-23"></a>  }</span>
<span id="cb5-24"><a href="#cb5-24"></a>  </span>
<span id="cb5-25"><a href="#cb5-25"></a>  <span class="cf">return</span> output;</span>
<span id="cb5-26"><a href="#cb5-26"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="fu">cpp_libgeos_init_api</span>()
<span class="fu">wkt_area</span>(<span class="st">"POLYGON ((0 0, 10 0, 10 10, 0 10, 0 0))"</span>)
<span class="co">#&gt; [1] 100</span>
</pre></div>
<p>If you compile the above with <code>-DLIBGEOS_DEBUG_MEMORY</code>, you can see that the C++ wrapper takes care of a lot of object shuffling under the hood!</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="fu">cpp_libgeos_init_api</span>()
<span class="fu">wkt_area</span>(<span class="st">"POLYGON ((0 0, 10 0, 10 10, 0 10, 0 0))"</span>)
<span class="co">#&gt; GEOS_init_r()</span>
<span class="co">#&gt; GEOSWKTReader_create_r()</span>
<span class="co">#&gt; LibGEOSGeometry(GEOSGeometry*)</span>
<span class="co">#&gt; GEOSGeom_destroy_r()</span>
<span class="co">#&gt; GEOSWKTReader_destroy_r()</span>
<span class="co">#&gt; GEOS_finish_r()</span>
<span class="co">#&gt; [1] 100</span>
</pre></div>
<p>This is especially useful if you’re running code that might error:</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="fu">wkt_area</span>(<span class="st">"POLYGON (0 0, 10 0, 10 10, 0 10, 0 0))"</span>)
<span class="co">#&gt; GEOS_init_r()</span>
<span class="co">#&gt; GEOSWKTReader_create_r()</span>
<span class="co">#&gt; GEOSWKTReader_destroy_r()</span>
<span class="co">#&gt; GEOS_finish_r()</span>
<span class="co">#&gt; Error in wkt_area("POLYGON (0 0, 10 0, 10 10, 0 10, 0 0))"): ParseException: Expected word but encountered number: '0'</span>
</pre></div>
<p>Other wrappers that might be useful are <code>LibGEOSWKTWriter</code>, <code>LibGEOSWKBReader</code>, <code>LibGEOSWKBWriter</code>, and <code>LibGEOSBufferParams</code>. In the future, there will probably also be a <code>LibGEOSSTRtree</code> to wrap indexes.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=libgeos">https://​cloud.r-project.org/​package=libgeos</a>
</li>
<li>Browse source code at <br><a href="https://github.com/paleolimbot/libgeos/">https://​github.com/​paleolimbot/​libgeos/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/paleolimbot/libgeos/issues">https://​github.com/​paleolimbot/​libgeos/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>LGPL (&gt;= 2.1)</small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Dewey Dunnington <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-9415-4582" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>GEOS authors <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Dewey Dunnington, GEOS authors.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
